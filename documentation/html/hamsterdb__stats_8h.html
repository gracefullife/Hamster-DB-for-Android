<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>hamsterdb Embedded Database: include/ham/hamsterdb_stats.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_c0d8a98264e9fca029e29689f2ac77e3.html">include</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_e272d089e922235d65965267c18ff737.html">ham</a>
  </div>
</div>
<div class="contents">
<h1>hamsterdb_stats.h File Reference</h1>
<p>Internal hamsterdb Embedded Storage statistics gathering and hinting functions.  
<a href="#_details">More...</a></p>
<code>#include &lt;<a class="el" href="hamsterdb_8h_source.html">ham/hamsterdb.h</a>&gt;</code><br/>

<p><a href="hamsterdb__stats_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structham__freelist__slotsize__stats__t.html">ham_freelist_slotsize_stats_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structham__freelist__page__statistics__t.html">ham_freelist_page_statistics_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structham__runtime__statistics__globdata__t.html">ham_runtime_statistics_globdata_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structham__runtime__statistics__opdbdata__t.html">ham_runtime_statistics_opdbdata_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structham__runtime__statistics__dbdata__t.html">ham_runtime_statistics_dbdata_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structham__statistics__t.html">ham_statistics_t</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hamsterdb__stats_8h.html#a889f5b7a31a167b9689b6c65018c9aec">HAM_STATISTICS_HIGH_WATER_MARK</a>&nbsp;&nbsp;&nbsp;0x7FFFFFFF</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hamsterdb__stats_8h.html#a18cda0e8746c0b92ca59db461032cd48">HAM_FREELIST_SLOT_SPREAD</a>&nbsp;&nbsp;&nbsp;(16-5+1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ham__operation__types.html#ga70fff0d371934a264f19c9521cd7d6cf">HAM_OPERATION_STATS_FIND</a>&nbsp;&nbsp;&nbsp;0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ham__operation__types.html#gae57e638cf37e5f4883bc3b3d3d42bf0c">HAM_OPERATION_STATS_INSERT</a>&nbsp;&nbsp;&nbsp;1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ham__operation__types.html#gaf26dac013831f5c2449461a396423b7e">HAM_OPERATION_STATS_ERASE</a>&nbsp;&nbsp;&nbsp;2</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ham__operation__types.html#ga09f062d228a6b3c6e5fcdb2b1c826b1e">HAM_OPERATION_STATS_MAX</a>&nbsp;&nbsp;&nbsp;3</td></tr>
<tr><td colspan="2"><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structham__statistics__t.html">ham_statistics_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hamsterdb__stats_8h.html#afccb388b502b4c5a8b9f6b047cc146f0">ham_statistics_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hamsterdb__stats_8h.html#ad5faa1c5e7d012405fe1e802e44962ac">ham_free_statistics_func_t</a> (<a class="el" href="structham__statistics__t.html">ham_statistics_t</a> *self)</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">HAM_EXPORT <a class="el" href="types_8h.html#a6855e1803e688775e92cd64b2a6d1064">ham_status_t</a> <br class="typebreak"/>
HAM_CALLCONV&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hamsterdb__stats_8h.html#a87f7ff293fb2f1810c319c816d8bc737">ham_clean_statistics_datarec</a> (<a class="el" href="structham__statistics__t.html">ham_statistics_t</a> *stats)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Internal hamsterdb Embedded Storage statistics gathering and hinting functions. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Ger Hobbelt, <a href="mailto:ger@hobbelt.com">ger@hobbelt.com</a></dd></dl>
<p>Please be aware that the interfaces in this file are mostly for internal use. Unlike those in <a class="el" href="hamsterdb_8h.html" title="Include file for hamsterdb Embedded Storage.">hamsterdb.h</a> they are not stable and can be changed with every new version. </p>

<p>Definition in file <a class="el" href="hamsterdb__stats_8h_source.html">hamsterdb_stats.h</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a18cda0e8746c0b92ca59db461032cd48"></a><!-- doxytag: member="hamsterdb_stats.h::HAM_FREELIST_SLOT_SPREAD" ref="a18cda0e8746c0b92ca59db461032cd48" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HAM_FREELIST_SLOT_SPREAD&nbsp;&nbsp;&nbsp;(16-5+1)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>As we [can] support record sizes up to 4Gb, at least theoretically, we can express this size range as a spanning DB_CHUNKSIZE size range: 1..N, where N = log2(4Gb) - log2(DB_CHUNKSIZE). As we happen to know DB_CHUNKSIZE == 32, at least for all regular hamsterdb builds, our biggest power-of-2 for the freelist slot count ~ 32-5 = 27, where 0 represents slot size = 1 DB_CHUNKSIZE, 1 represents size of 2 DB_CHUNKSIZEs, 2 ~ 4 DB_CHUNKSIZEs, and so on.</p>
<p>EDIT: In order to cut down on statistics management cost due to overhead caused by having to keep up with the latest for VERY large sizes, we cut this number down to support sizes up to a maximum size of 64Kb ~ 2^16, meaning any requests for more than 64Kb/CHUNKSIZE bytes is sharing their statistics. </p>

<p>Definition at line <a class="el" href="hamsterdb__stats_8h_source.html#l00071">71</a> of file <a class="el" href="hamsterdb__stats_8h_source.html">hamsterdb_stats.h</a>.</p>

</div>
</div>
<a class="anchor" id="a889f5b7a31a167b9689b6c65018c9aec"></a><!-- doxytag: member="hamsterdb_stats.h::HAM_STATISTICS_HIGH_WATER_MARK" ref="a889f5b7a31a167b9689b6c65018c9aec" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HAM_STATISTICS_HIGH_WATER_MARK&nbsp;&nbsp;&nbsp;0x7FFFFFFF</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The upper bound value which will trigger a statistics data rescale operation to be initiated in order to prevent integer overflow in the statistics data elements. </p>

<p>Definition at line <a class="el" href="hamsterdb__stats_8h_source.html#l00052">52</a> of file <a class="el" href="hamsterdb__stats_8h_source.html">hamsterdb_stats.h</a>.</p>

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="ad5faa1c5e7d012405fe1e802e44962ac"></a><!-- doxytag: member="hamsterdb_stats.h::ham_free_statistics_func_t" ref="ad5faa1c5e7d012405fe1e802e44962ac" args="(ham_statistics_t *self)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void <a class="el" href="hamsterdb__stats_8h.html#ad5faa1c5e7d012405fe1e802e44962ac">ham_free_statistics_func_t</a>(<a class="el" href="structham__statistics__t.html">ham_statistics_t</a> *self)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>function prototype for the hamsterdb-specified <a class="el" href="structham__statistics__t.html">ham_statistics_t</a> cleanup function.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__ham__database.html#gac6aa75dbc0d6f9c00e52530067ee27fc">HAM_PARAM_GET_STATISTICS</a> </dd>
<dd>
<a class="el" href="structham__statistics__t.html">ham_statistics_t</a> </dd>
<dd>
<a class="el" href="hamsterdb__stats_8h.html#a87f7ff293fb2f1810c319c816d8bc737">ham_clean_statistics_datarec</a> </dd></dl>

<p>Definition at line <a class="el" href="hamsterdb__stats_8h_source.html#l00045">45</a> of file <a class="el" href="hamsterdb__stats_8h_source.html">hamsterdb_stats.h</a>.</p>

</div>
</div>
<a class="anchor" id="afccb388b502b4c5a8b9f6b047cc146f0"></a><!-- doxytag: member="hamsterdb_stats.h::ham_statistics_t" ref="afccb388b502b4c5a8b9f6b047cc146f0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structham__statistics__t.html">ham_statistics_t</a> <a class="el" href="structham__statistics__t.html">ham_statistics_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="hamsterdb__stats_8h_source.html#l00034">34</a> of file <a class="el" href="hamsterdb__stats_8h_source.html">hamsterdb_stats.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a87f7ff293fb2f1810c319c816d8bc737"></a><!-- doxytag: member="hamsterdb_stats.h::ham_clean_statistics_datarec" ref="a87f7ff293fb2f1810c319c816d8bc737" args="(ham_statistics_t *stats)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAM_EXPORT <a class="el" href="types_8h.html#a6855e1803e688775e92cd64b2a6d1064">ham_status_t</a> HAM_CALLCONV ham_clean_statistics_datarec </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structham__statistics__t.html">ham_statistics_t</a> *&nbsp;</td>
          <td class="paramname"> <em>stats</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Invoke the optional <a class="el" href="structham__statistics__t.html">ham_statistics_t</a> content cleanup function.</p>
<p>This function will check whether the <a class="el" href="structham__statistics__t.html">ham_statistics_t</a> free/cleanup callback has been set or not before invoking it.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>stats</em>&nbsp;</td><td>A pointer to a valid <a class="el" href="structham__statistics__t.html">ham_statistics_t</a> data structure. 'Valid' means you must call this <a class="el" href="hamsterdb__stats_8h.html#a87f7ff293fb2f1810c319c816d8bc737">ham_clean_statistics_datarec()</a> function <em>after</em> having called <a class="el" href="group__ham__env.html#ga1da6fd9eee42c7d0c6e4a23dd7e5c059">ham_env_get_parameters</a> or <a class="el" href="group__ham__database.html#gadbcbed98c301c6e6d76c84ebe3a147dd">ham_get_parameters</a> with a <a class="el" href="group__ham__database.html#gac6aa75dbc0d6f9c00e52530067ee27fc">HAM_PARAM_GET_STATISTICS</a> <a class="el" href="structham__parameter__t.html">ham_parameter_t</a> entry which had this <a class="el" href="structham__statistics__t.html">ham_statistics_t</a> reference <em>stats</em> attached and <em>before</em> either the related <a class="el" href="hamsterdb_8h.html#a6bc485e4975cd65160c0e8ec86a9b143">ham_db_t</a> or <a class="el" href="hamsterdb_8h.html#a76a9536ed7a9615d8ebc02b02092a82b">ham_env_t</a> handles are closed (<a class="el" href="group__ham__env.html#gaec7ee5ca832fa06438b4806ae5e096c4">ham_env_close</a>/<a class="el" href="group__ham__database.html#gac0e1e492c2b36e2ae0e87d0c0ff6e04e">ham_close</a>) or deleted (<a class="el" href="group__ham__env.html#ga0a04486b89b7db739ccde814014c1079">ham_env_delete</a>/<a class="el" href="group__ham__database.html#ga091d09e58f8df91fd4a490514719e852">ham_delete</a>).</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="group__ham__status__codes.html#ga996267ce00baef28c04eecdcb2241bf3">HAM_SUCCESS</a> upon success </dd>
<dd>
<a class="el" href="group__ham__status__codes.html#ga86278fac7e593aab73ee5da21ec02435">HAM_INV_PARAMETER</a> if the <em>stats</em> pointer is NULL</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__ham__database.html#gac6aa75dbc0d6f9c00e52530067ee27fc">HAM_PARAM_GET_STATISTICS</a> </dd>
<dd>
<a class="el" href="hamsterdb__stats_8h.html#a87f7ff293fb2f1810c319c816d8bc737">ham_clean_statistics_datarec</a> </dd>
<dd>
<a class="el" href="group__ham__database.html#gadbcbed98c301c6e6d76c84ebe3a147dd">ham_get_parameters</a> </dd>
<dd>
<a class="el" href="group__ham__env.html#ga1da6fd9eee42c7d0c6e4a23dd7e5c059">ham_env_get_parameters</a> </dd></dl>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Wed Apr 14 20:37:55 2010 for hamsterdb Embedded Database by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
